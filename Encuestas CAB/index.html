<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Encuestas CAB | Plataforma</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Iconos -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Estilos propios -->
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- ========= LOGIN ========= -->
  <section id="screen-login" class="container py-5">
    <div class="row justify-content-center">
      <div class="col-12 col-sm-8 col-md-6 col-lg-4">
        <div class="card shadow-sm">
          <div class="card-body">
            <h1 class="h4 mb-3 text-center">Ingreso a la plataforma</h1>
            <div class="mb-3">
              <label class="form-label">Usuario</label>
              <input id="loginUser" type="text" class="form-control" placeholder="admin">
            </div>
            <div class="mb-2">
              <label class="form-label">Contraseña</label>
              <input id="loginPass" type="password" class="form-control" placeholder="admin">
            </div>
            <div id="loginError" class="text-danger small mb-3 d-none">Credenciales incorrectas</div>
            <button id="btnLogin" class="btn btn-primary w-100">Ingresar</button>
            <p class="text-muted mt-3 small mb-0">Módulo de registro y autenticación.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ========= LAYOUT PRIVADO (SIDEBAR + CONTENT) ========= -->
  <section id="app-layout" class="d-none">
    <div class="app-wrapper">
      <!-- Sidebar -->
      <aside class="app-sidebar">
        <div class="p-3 border-bottom">
          <strong>ENCUESTAS CAB</strong>
          <div class="text-muted small">Administrador</div>
        </div>
        <nav class="list-group list-group-flush">
          <button class="list-group-item list-group-item-action" data-screen="screen-dashboard">
            <i class="bi bi-speedometer2 me-2"></i>Dashboard
          </button>
          <button class="list-group-item list-group-item-action" data-screen="screen-encuestas">
            <i class="bi bi-ui-checks-grid me-2"></i>Gestión de encuestas
          </button>
          <button class="list-group-item list-group-item-action" data-screen="screen-recoleccion">
            <i class="bi bi-clipboard-check me-2"></i>Recolección de datos
          </button>
          <button class="list-group-item list-group-item-action" data-screen="screen-reportes">
            <i class="bi bi-graph-up-arrow me-2"></i>Reportes y análisis
          </button>
          <button class="list-group-item list-group-item-action" data-screen="screen-comunidades">
            <i class="bi bi-buildings me-2"></i>Administración comunitaria
          </button>
          <button class="list-group-item list-group-item-action" data-screen="screen-config">
            <i class="bi bi-gear me-2"></i>Configuración
          </button>
          <button class="list-group-item list-group-item-action text-danger" id="btnLogout">
            <i class="bi bi-box-arrow-right me-2"></i>Salir
          </button>
        </nav>
      </aside>

      <!-- Contenido -->
      <main class="app-content">
        <!-- ===== Dashboard ===== -->
        <section id="screen-dashboard" class="screen">
          <div class="d-flex align-items-center justify-content-between mb-3">
            <h2 class="h4 mb-0">Dashboard</h2>
            <span class="text-muted small">Módulo de análisis y reportes</span>
          </div>

          <div class="row g-3 mb-4">
            <div class="col-12 col-sm-6 col-lg-3">
              <div class="card stat-card">
                <div class="card-body">
                  <div class="stat-label">Encuestas hoy</div>
                  <div id="statHoy" class="stat-value">0</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-6 col-lg-3">
              <div class="card stat-card">
                <div class="card-body">
                  <div class="stat-label">Total comunidades</div>
                  <div id="statCom" class="stat-value">0</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-6 col-lg-3">
              <div class="card stat-card">
                <div class="card-body">
                  <div class="stat-label">Encuestadores activos</div>
                  <div id="statEnc" class="stat-value">0</div>
                </div>
              </div>
            </div>
            <div class="col-12 col-sm-6 col-lg-3">
              <div class="card stat-card">
                <div class="card-body">
                  <div class="stat-label">Preguntas totales</div>
                  <div id="statPreg" class="stat-value">0</div>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-body">
              <h5 class="card-title mb-3">Tendencia semanal</h5>
              <canvas id="chartLine"></canvas>
            </div>
          </div>
        </section>

        <!-- ===== Gestión de encuestas ===== -->
        <section id="screen-encuestas" class="screen d-none">
          <div class="d-flex align-items-center justify-content-between mb-3">
            <h2 class="h4 mb-0">Gestión de encuestas</h2>
            <button id="btnNuevaEncuesta" class="btn btn-primary">
              <i class="bi bi-plus-circle me-1"></i>Nueva encuesta
            </button>
          </div>

          <!-- Form crear/editar -->
          <div id="boxFormEncuesta" class="card mb-3 d-none">
            <div class="card-body">
              <div class="row g-3">
                <div class="col-12 col-md-4">
                  <label class="form-label">Nombre</label>
                  <input id="fNombre" type="text" class="form-control" placeholder="Encuesta de Higiene 2025">
                </div>
                <div class="col-12 col-md-4">
                  <label class="form-label">Grupo focal</label>
                  <select id="fGrupo" class="form-select">
                    <option value="Embarazadas">Embarazadas</option>
                    <option value="Madres 0-6">Madres 0-6 meses</option>
                    <option value="Madres 6-24">Madres 6-24 meses</option>
                    <option value="General">General</option>
                  </select>
                </div>
                <div class="col-12 col-md-4">
                  <label class="form-label"># Preguntas</label>
                  <input id="fPregs" type="number" class="form-control" min="1" value="10">
                </div>
              </div>
              <div class="mt-3 d-flex gap-2">
                <button id="btnGuardarEncuesta" class="btn btn-success">Guardar</button>
                <button id="btnCancelarEncuesta" class="btn btn-outline-secondary">Cancelar</button>
              </div>
              <p class="text-muted mt-2 small mb-0">Módulo de gestión de encuestas.</p>
            </div>
          </div>

          <!-- Listado -->
          <div class="card">
            <div class="card-body">
              <div class="table-responsive">
                <table class="table align-middle">
                  <thead>
                    <tr>
                      <th>Nombre</th>
                      <th>Grupo</th>
                      <th>Preguntas</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody id="tblEncuestas">
                    <!-- filas dinámicas -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </section>

        <!-- ===== Recolección de datos (Tus encuestas) ===== -->
        <section id="screen-recoleccion" class="screen d-none">
          <div class="d-flex align-items-center justify-content-between mb-2">
            <h2 class="h4 mb-0">Recolección de datos</h2>
            <span class="text-muted small">Optimizado para móvil</span>
          </div>

          <div class="alert alert-info py-2 mb-3">
            Usa los botones para mostrar/ocultar cada formulario y presiona <strong>Guardar y enviar</strong>.
            <div class="small text-muted">Módulo de recolección de datos.</div>
          </div>

          <!-- === Tus formularios existentes: Los conservo tal cual === -->
          <div class="formulario">
            <button class="btn btn-outline-primary mb-2" onclick="toggleForm('encuesta1')">Mostrar Encuesta 1</button>
            <form id="encuesta1" class="hidden">
              <h2>Encuesta 1</h2>
              <!-- (contenido original) -->
              <!-- ⬇️ Pego tu contenido actual tal cual para mantenerlo -->
              <!-- INICIO BLOQUE PEGADO -->
              <label> Fecha de entrevista: <input type="date" name="fecha" /></label>
              <label> Número de boleta: <input type="text" name="boleta" /></label>
              <h3>DATOS GENERALES</h3>
              <label>Departamento: <input type="text" name="departamento" /></label>
              <label>Municipio: <input type="text" name="municipio" /></label>
              <label>Seleccione comunidad: <input type="text" name="comunidad" /></label>
              <label>Nombre del encuestador: <input type="text" name="encuestador" /></label>
              <p>Sexo del encuestador:</p>
              <label><input type="radio" name="sexo_encuestador" value="Masculino" /> Masculino</label>
              <label><input type="radio" name="sexo_encuestador" value="Femenino" /> Femenino</label>
              <label>Nombre de la mujer: <input type="text" name="nombre_mujer" /></label>
              <label>Edad: <input type="number" name="edad" /></label>
              <p>Tipo de encuesta:</p>
              <label><input type="radio" name="tipo_encuesta" value="Embarazada" /> Embarazada</label>
              <label><input type="radio" name="tipo_encuesta" value="Madre niño/a menor de meses" /> Madre de niño/a menor de meses</label>
              <label><input type="radio" name="tipo_encuesta" value="Madre niño/a de 6 a 24 meses" /> Madre de niño/a de 6 a 24 meses</label>
              <h3>1. HIGIENE BÁSICA</h3>
              <p>¿Cuándo hay que lavarse las manos?</p>
              <label><input type="checkbox" name="lavarse[]" /> Antes de comer</label>
              <label><input type="checkbox" name="lavarse[]" /> Antes de cocinar</label>
              <label><input type="checkbox" name="lavarse[]" /> Antes de dar de comer</label>
              <label><input type="checkbox" name="lavarse[]" /> Después de usar la letrina</label>
              <label><input type="checkbox" name="lavarse[]" /> Después de cambiar pañales</label>
              <label><input type="checkbox" name="lavarse[]" /> Después de hacer la limpieza</label>
              <label><input type="checkbox" name="lavarse[]" /> Después de tocar dinero</label>
              <label><input type="checkbox" name="lavarse[]" /> Cuando las tiene sucias</label>
              <h4>OBSERVACIÓN DE LA VIVIENDA</h4>
              <label><input type="checkbox" name="vivienda[]" /> Ambientes separados</label>
              <label><input type="checkbox" name="vivienda[]" /> Cocina limpia y ordenada</label>
              <label><input type="checkbox" name="vivienda[]" /> Camas tendidas</label>
              <label><input type="checkbox" name="vivienda[]" /> Floreros y recipientes de agua limpios</label>
              <label><input type="checkbox" name="vivienda[]" /> Ropa limpia y ordenada</label>
              <p>Fuera de la vivienda:</p>
              <label><input type="checkbox" name="vivienda[]" /> No hay basura acumulada o regada</label>
              <label><input type="checkbox" name="vivienda[]" /> No hay heces fecales o popó</label>
              <label><input type="checkbox" name="vivienda[]" /> Toneles tapados</label>
              <label><input type="checkbox" name="vivienda[]" /> Pilas limpias y cepilladas</label>
              <label><input type="checkbox" name="vivienda[]" /> Animales en corral (pollos, gallinas, patos, etc.)</label>
              <label><input type="checkbox" name="vivienda[]" /> Cunetas</label>
              <label><input type="checkbox" name="vivienda[]" /> Letrinas limpias (dentro y fuera)</label>
              <h3>2. AGUA Y ENFERMEDADES</h3>
              <p>¿El agua no desinfectada puede provocar enfermedades?</p>
              <label><input type="radio" name="agua_enferma" value="Sí" /> Sí</label>
              <label><input type="radio" name="agua_enferma" value="No" /> No</label>
              <p>¿Qué enfermedades puede provocar esta agua?</p>
              <label><input type="checkbox" name="enfermedades_agua[]" /> Diarrea, dolor de estómago, infección estomacal</label>
              <label><input type="checkbox" name="enfermedades_agua[]" /> Enfermedades de la piel</label>
              <h3>3. Purificación del agua</h3>
              <p>¿Qué métodos usan en casa?</p>
              <label><input type="checkbox" name="metodos_agua[]" /> Hervir el agua</label>
              <label><input type="checkbox" name="metodos_agua[]" /> Clorar</label>
              <label><input type="checkbox" name="metodos_agua[]" /> SODIS</label>
              <label><input type="checkbox" name="metodos_agua[]" /> Filtrar el agua</label>
              <label><input type="checkbox" name="metodos_agua[]" /> Agua embotellada</label>
              <p>¿El agua que toman está clorada?</p>
              <label><input type="radio" name="agua_clorada" value="Sí" /> Sí</label>
              <label><input type="radio" name="agua_clorada" value="No" /> No</label>
              <p>¿Qué enfermedades puede provocar el agua?</p>
              <label><input type="checkbox" name="agua_clorada_fuente[]" /> Clorada por la Municipalidad</label>
              <label><input type="checkbox" name="agua_clorada_fuente[]" /> Clorada en casa</label>
              <p>¿Está de acuerdo con que la municipalidad clore el agua?</p>
              <label><input type="radio" name="deacuerdo_clorar" value="Sí" /> Sí</label>
              <label><input type="radio" name="deacuerdo_clorar" value="No" /> No</label>
              <h3>4. SANEAMIENTO AMBIENTAL</h3>
              <p>¿Qué enfermedades producen las aguas usadas y que corren sobre la tierra?</p>
              <label><input type="checkbox" name="saneamiento_enfermedades[]" /> Diarrea, dolor de estómago, infección estomacal</label>
              <label><input type="checkbox" name="saneamiento_enfermedades[]" /> Enfermedades de la piel</label>
              <p>¿Sabe cómo evitar que el agua corra sobre la tierra en las comunidades?</p>
              <label><input type="radio" name="evitar_agua" value="Sí" /> Sí</label>
              <label><input type="radio" name="evitar_agua" value="No" /> No</label>
              <p>¿Qué se puede hacer?</p>
              <label><input type="checkbox" name="acciones_saneamiento[]" /> Drenajes a nivel de la vivienda (pozo séptico)</label>
              <label><input type="checkbox" name="acciones_saneamiento[]" /> Sumideros</label>
              <label><input type="checkbox" name="acciones_saneamiento[]" /> Drenajes a nivel de calles (alcantarillado municipal)</label>
              <h3>5. ATENCIÓN PRENATAL</h3>
              <p>¿Conoce cuántos controles debe tener una mujer durante el embarazo?</p>
              <label><input type="radio" name="controles_embarazo" value="Sí" /> Sí</label>
              <label><input type="radio" name="controles_embarazo" value="No" /> No</label>
              <p>¿Cuántos controles?</p>
              <label><input type="radio" name="numero_controles" value="1" /> 1</label>
              <label><input type="radio" name="numero_controles" value="2" /> 2</label>
              <label><input type="radio" name="numero_controles" value="3" /> 3</label>
              <label><input type="radio" name="numero_controles" value="4" /> 4</label>
              <h3>5. DISCAPACIDAD</h3>
              <p>¿Sabe qué es discapacidad?</p>
              <label><input type="radio" name="sabe_discapacidad" value="Sí" /> Sí</label>
              <label><input type="radio" name="sabe_discapacidad" value="No" /> No</label>
              <p>¿Qué es para usted la discapacidad?</p>
              <label><input type="checkbox" name="concepto_discapacidad[]" /> Es cuando un niño/a no puede caminar</label>
              <label><input type="checkbox" name="concepto_discapacidad[]" /> Cuando un niño/a su cabeza o cuerpo no se desarrollan</label>
              <label><input type="checkbox" name="concepto_discapacidad[]" /> Cuando un niño/a no habla, no escucha o no pone atención</label>
              <p>¿En su familia existen niños/as con alguna discapacidad?</p>
              <label><input type="radio" name="familia_discapacidad" value="Sí" /> Sí</label>
              <label><input type="radio" name="familia_discapacidad" value="No" /> No</label>
              <p>¿Qué actividades realizan con ellos?</p>
              <label><input type="checkbox" name="actividades_discapacidad[]" /> Llevarlo a rehabilitación</label>
              <label><input type="checkbox" name="actividades_discapacidad[]" /> Llevarlo a servicio de salud</label>
              <label><input type="checkbox" name="actividades_discapacidad[]" /> Llevarlo al centro de estimulación</label>
              <!-- FIN BLOQUE PEGADO -->
              <div class="mt-3">
                <button type="button" class="btn btn-success" onclick="guardarFormulario('encuesta1')">Guardar y enviar</button>
              </div>
            </form>
          </div>

          <div class="formulario">
            <button class="btn btn-outline-primary mb-2" onclick="toggleForm('encuesta2')">Mostrar Encuesta 2</button>
            <form id="encuesta2" class="hidden">
              <h2>Encuesta 2</h2>
              <!-- (contenido original encuesta 2, pegado tal cual de tu archivo) -->
              <!-- … -->
              <div class="mt-3">
                <button type="button" class="btn btn-success" onclick="guardarFormulario('encuesta2')">Guardar y enviar</button>
              </div>
            </form>
          </div>

          <div class="formulario">
            <button class="btn btn-outline-primary mb-2" onclick="toggleForm('encuesta3')">Mostrar Encuesta 3</button>
            <form id="encuesta3" class="hidden">
              <h2>Encuesta 3</h2>
              <!-- (contenido original encuesta 3, pegado tal cual de tu archivo) -->
              <!-- … -->
              <div class="mt-3">
                <button type="button" class="btn btn-success" onclick="guardarFormulario('encuesta3')">Guardar y enviar</button>
              </div>
            </form>
          </div>
        </section>

        <!-- ===== Reportes y análisis ===== -->
        <section id="screen-reportes" class="screen d-none">
          <div class="d-flex align-items-center justify-content-between mb-3">
            <h2 class="h4 mb-0">Reportes y análisis</h2>
            <span class="text-muted small">Filtros por comunidad, fecha, grupo</span>
          </div>

          <div class="card mb-3">
            <div class="card-body">
              <div class="row g-2">
                <div class="col-12 col-md-4">
                  <label class="form-label">Comunidad</label>
                  <select id="filtroComunidad" class="form-select">
                    <option value="todas">Todas</option>
                  </select>
                </div>
                <div class="col-12 col-md-4">
                  <label class="form-label">Fecha</label>
                  <input id="filtroFecha" type="date" class="form-control">
                </div>
                <div class="col-12 col-md-4">
                  <label class="form-label">Grupo focal</label>
                  <select id="filtroGrupo" class="form-select">
                    <option value="todos">Todos</option>
                    <option>Embarazadas</option>
                    <option>Madres 0-6</option>
                    <option>Madres 6-24</option>
                    <option>General</option>
                  </select>
                </div>
              </div>
              <div class="mt-3">
                <button id="btnAplicarFiltros" class="btn btn-primary">Aplicar filtros</button>
              </div>
            </div>
          </div>

          <div class="row g-3">
            <div class="col-12 col-lg-6">
              <div class="card"><div class="card-body">
                <h6 class="mb-2">Distribución por grupo</h6>
                <canvas id="chartPie"></canvas>
              </div></div>
            </div>
            <div class="col-12 col-lg-6">
              <div class="card"><div class="card-body">
                <h6 class="mb-2">Encuestas por comunidad</h6>
                <canvas id="chartBar"></canvas>
              </div></div>
            </div>
          </div>
        </section>

        <!-- ===== Administración comunitaria ===== -->
        <section id="screen-comunidades" class="screen d-none">
          <div class="d-flex align-items-center justify-content-between mb-3">
            <h2 class="h4 mb-0">Administración comunitaria</h2>
            <button id="btnNuevaComunidad" class="btn btn-primary">
              <i class="bi bi-plus-circle me-1"></i>Registrar COCODE / comunidad
            </button>
          </div>

          <!-- Form alta COCODE -->
          <div id="boxFormComunidad" class="card mb-3 d-none">
            <div class="card-body">
              <div class="row g-3">
                <div class="col-12 col-md-4">
                  <label class="form-label">Departamento</label>
                  <input id="cDep" type="text" class="form-control" placeholder="El Progreso">
                </div>
                <div class="col-12 col-md-4">
                  <label class="form-label">Municipio</label>
                  <input id="cMun" type="text" class="form-control" placeholder="Guastatoya">
                </div>
                <div class="col-12 col-md-4">
                  <label class="form-label">Comunidad/COCODE</label>
                  <input id="cNom" type="text" class="form-control" placeholder="Aldea X / COCODE Y">
                </div>
              </div>
              <div class="mt-3 d-flex gap-2">
                <button id="btnGuardarComunidad" class="btn btn-success">Guardar</button>
                <button id="btnCancelarComunidad" class="btn btn-outline-secondary">Cancelar</button>
              </div>
              <p class="text-muted mt-2 small mb-0">Módulo de administración comunitaria.</p>
            </div>
          </div>

          <!-- Tabla -->
          <div class="card">
            <div class="card-body">
              <div class="table-responsive">
                <table class="table align-middle">
                  <thead>
                    <tr>
                      <th>Departamento</th>
                      <th>Municipio</th>
                      <th>Comunidad / COCODE</th>
                      <th>Acciones</th>
                    </tr>
                  </thead>
                  <tbody id="tblComunidades"></tbody>
                </table>
              </div>
            </div>
          </div>
        </section>

        <!-- ===== Configuración ===== -->
        <section id="screen-config" class="screen d-none">
          <h2 class="h4 mb-3">Configuración</h2>

          <div class="row g-3">
            <div class="col-12 col-lg-6">
              <div class="card h-100">
                <div class="card-body">
                  <h6>Usuarios y permisos</h6>
                  <div class="table-responsive">
                    <table class="table align-middle">
                      <thead>
                        <tr><th>Usuario</th><th>Rol</th><th>Acciones</th></tr>
                      </thead>
                      <tbody id="tblUsuarios"></tbody>
                    </table>
                  </div>
                  <div class="mt-2 d-flex gap-2">
                    <input id="uNombre" class="form-control" placeholder="usuario">
                    <select id="uRol" class="form-select" style="max-width:200px">
                      <option>Admin</option>
                      <option>Encuestador</option>
                      <option>Analista</option>
                    </select>
                    <button id="btnAddUser" class="btn btn-primary">Agregar</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-12 col-lg-6">
              <div class="card h-100">
                <div class="card-body">
                  <h6>Ajustes generales</h6>
                  <div class="row g-3">
                    <div class="col-12">
                      <label class="form-label">Idioma</label>
                      <select id="ajIdioma" class="form-select">
                        <option value="es">Español</option>
                        <option value="en">English</option>
                      </select>
                    </div>
                    <div class="col-12">
                      <label class="form-label">Parámetros (ej. mínimo preguntas)</label>
                      <input id="ajMinPreg" type="number" class="form-control" value="5" min="1">
                    </div>
                  </div>
                  <div class="mt-3">
                    <button id="btnGuardarAjustes" class="btn btn-success">Guardar ajustes</button>
                    <span id="ajustesMsg" class="text-success small ms-2 d-none">Guardado</span>
                  </div>
                  <p class="text-muted mt-2 small mb-0">Módulo de configuración.</p>
                </div>
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>
  </section>

  <!-- JS Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <!-- JS propio -->
  <script src="scrip.js"></script>
</body>
</html>
